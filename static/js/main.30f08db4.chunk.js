(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{110:function(e,a){},112:function(e,a){},130:function(e,a,t){},131:function(e,a,t){"use strict";t.r(a);var c=t(0),n=t(9),s=t.n(n),i=t(171),r=t(166),l=t(161),o=t(164),d=t(132),j=t(37),b=t.n(j),m=t(47),x=t.n(m),u=t(4);const p=Object(c.createContext)(),O=Object(j.io)("ws://videochat-env-1.eba-4czevz3r.us-east-2.elasticbeanstalk.com/"),h=e=>{let{children:a}=e;const[t,n]=Object(c.useState)(!1),[s,i]=Object(c.useState)(!1),[r,l]=Object(c.useState)(),[o,d]=Object(c.useState)(""),[j,b]=Object(c.useState)({}),[m,h]=Object(c.useState)(""),g=Object(c.useRef)(),v=Object(c.useRef)(),f=Object(c.useRef)();Object(c.useEffect)((()=>{navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((e=>{l(e),g.current.srcObject=e})),O.on("me",(e=>{h(e)})),O.on("callUser",(e=>{let{from:a,name:t,signal:c}=e;b({isReceivingCall:!0,from:a,name:t,signal:c})})),O.on("receiveMessage",(e=>{console.log("New message received:",e)}))}),[]);return Object(u.jsx)(p.Provider,{value:{call:j,callAccepted:t,myVideo:g,userVideo:v,stream:r,name:o,setName:d,callEnded:s,me:m,callUser:e=>{const a=new x.a({initiator:!0,trickle:!1,stream:r});a.on("signal",(a=>{O.emit("callUser",{userToCall:e,signalData:a,from:m,name:o})})),a.on("stream",(e=>{v.current.srcObject=e})),O.on("callAccepted",(e=>{n(!0),a.signal(e)})),f.current=a},leaveCall:()=>{i(!0),f.current.destroy(),window.location.reload()},answerCall:()=>{n(!0);const e=new x.a({initiator:!1,trickle:!1,stream:r});e.on("signal",(e=>{O.emit("answerCall",{signal:e,to:j.from})})),e.on("stream",(e=>{v.current.srcObject=e})),e.signal(j.signal),f.current=e},sendMessage:e=>{O.emit("newMessage",e)}},children:a})},g=Object(l.a)((e=>({video:{width:"550px",[e.breakpoints.down("xs")]:{width:"300px"}},gridContainer:{justifyContent:"center",[e.breakpoints.down("xs")]:{flexDirection:"column"}},paper:{padding:"10px",border:"2px solid black",margin:"10px"}})));var v=()=>{const{name:e,callAccepted:a,myVideo:t,userVideo:n,callEnded:s,stream:i,call:l}=Object(c.useContext)(p),j=g();return Object(u.jsxs)(o.a,{container:!0,className:j.gridContainer,children:[i&&Object(u.jsx)(d.a,{className:j.paper,children:Object(u.jsxs)(o.a,{item:!0,xs:12,md:6,children:[Object(u.jsx)(r.a,{variant:"h5",gutterBottom:!0,children:e||"Name"}),Object(u.jsx)("video",{playsInline:!0,muted:!0,ref:t,autoPlay:!0,className:j.video})]})}),a&&!s&&Object(u.jsx)(d.a,{className:j.paper,children:Object(u.jsxs)(o.a,{item:!0,xs:12,md:6,children:[Object(u.jsx)(r.a,{variant:"h5",gutterBottom:!0,children:l.name||"Name"}),Object(u.jsx)("video",{playsInline:!0,ref:n,autoPlay:!0,className:j.video})]})})]})},f=t(167),C=t(172),w=t(173),y=t(76),N=t(168),k=t(169),S=t(170);const I=Object(l.a)((e=>({root:{display:"flex",flexDirection:"column"},gridContainer:{width:"100%",[e.breakpoints.down("xs")]:{flexDirection:"column"}},container:{width:"600px",margin:"35px 0",padding:0,[e.breakpoints.down("xs")]:{width:"80%"}},margin:{marginTop:20},padding:{padding:20},paper:{padding:"10px 20px",border:"2px solid black"}})));var M=e=>{let{children:a}=e;const{me:t,callAccepted:n,name:s,setName:i,callEnded:l,leaveCall:j,callUser:b,sendMessage:m}=Object(c.useContext)(p),[x,O]=Object(c.useState)(""),h=I(),[g,v]=Object(c.useState)("");return Object(u.jsx)(f.a,{className:h.container,children:Object(u.jsxs)(d.a,{elevation:10,className:h.paper,children:[Object(u.jsx)("form",{className:h.root,noValidate:!0,autoComplete:"off",children:Object(u.jsxs)(o.a,{container:!0,className:h.gridContainer,children:[Object(u.jsxs)(o.a,{item:!0,xs:12,md:6,className:h.padding,children:[Object(u.jsx)(r.a,{gutterBottom:!0,variant:"h6",children:"Account Info"}),Object(u.jsx)(C.a,{label:"Name",value:s,onChange:e=>i(e.target.value),fullWidth:!0}),Object(u.jsx)(y.CopyToClipboard,{text:t,className:h.margin,children:Object(u.jsx)(w.a,{variant:"contained",color:"primary",fullWidth:!0,startIcon:Object(u.jsx)(N.a,{fontSize:"large"}),children:"Copy Your ID"})})]}),Object(u.jsxs)(o.a,{item:!0,xs:12,md:6,className:h.padding,children:[Object(u.jsx)(r.a,{gutterBottom:!0,variant:"h6",children:"Make a call"}),Object(u.jsx)(C.a,{label:"ID to call",value:x,onChange:e=>O(e.target.value),fullWidth:!0}),n&&!l?Object(u.jsx)(w.a,{variant:"contained",color:"secondary",startIcon:Object(u.jsx)(k.a,{fontSize:"large"}),fullWidth:!0,onClick:j,className:h.margin,children:"Hang Up"}):Object(u.jsx)(w.a,{variant:"contained",color:"primary",startIcon:Object(u.jsx)(S.a,{fontSize:"large"}),fullWidth:!0,onClick:()=>b(x),className:h.margin,children:"Call"})]}),Object(u.jsx)(o.a,{children:Object(u.jsxs)("div",{children:[Object(u.jsx)(C.a,{label:"Message",fullWidth:!0,value:g,onChange:e=>v(e.target.value)}),Object(u.jsx)(w.a,{variant:"contained",color:"primary",fullWidth:!0,onClick:()=>{m(g),v("")},children:"Send"})]})})]})}),a]})})};var D=()=>{const{answerCall:e,call:a,callAccepted:t}=Object(c.useContext)(p);return Object(u.jsx)(u.Fragment,{children:a.isReceivingCall&&!t&&Object(u.jsxs)("div",{style:{display:"flex",justifyContent:"space-around"},children:[Object(u.jsxs)("h1",{children:[a.name," is calling:"]}),Object(u.jsx)(w.a,{variant:"contained",color:"primary",onClick:e,children:"Answer"})]})})};const z=b.a.connect("ws://videochat-env-1.eba-4czevz3r.us-east-2.elasticbeanstalk.com/");var A=()=>{const[e,a]=Object(c.useState)([]);return Object(c.useEffect)((()=>(z.on("receiveMessage",(e=>{console.log("New message received:",e),a((a=>[...a,e]))})),()=>{z.off("receiveMessage")})),[]),Object(u.jsxs)("div",{children:[Object(u.jsx)("h2",{children:"Received Messages"}),Object(u.jsx)("ul",{children:e.map(((e,a)=>Object(u.jsx)("li",{children:e},a)))})]})};const B=Object(l.a)((e=>({appBar:{borderRadius:15,margin:"30px 100px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",width:"600px",border:"2px solid black",[e.breakpoints.down("xs")]:{width:"90%"}},image:{marginLeft:"15px"},wrapper:{display:"flex",flexDirection:"column",alignItems:"center",width:"100%"}})));var R=()=>{const e=B();return Object(u.jsxs)("div",{className:e.wrapper,children:[Object(u.jsx)(i.a,{className:e.appBar,position:"static",color:"inherit",children:Object(u.jsx)(r.a,{variant:"h2",align:"center",children:"Video Chat"})}),Object(u.jsx)(v,{}),Object(u.jsxs)(M,{children:[Object(u.jsx)(D,{}),Object(u.jsx)(A,{})]})]})};t(130);s.a.render(Object(u.jsx)(h,{children:Object(u.jsx)(R,{})}),document.getElementById("root"))}},[[131,1,2]]]);
//# sourceMappingURL=main.30f08db4.chunk.js.map